### **产品需求文档 (PRD) - 高考志愿AI决策顾问 (MVP版)**

* **产品名称:** 高考志愿AI决策顾问 (免费体验版)
* **版本:** V1.1
* **发布日期:** 2025年6月22日
* **文档负责人:** (您的名字/产品经理)

## 版本历史
- V1.1（2025-06-24）：新增极简用户认证与速率限制、多轮对话、极简数据导入等功能。
- V1.0（2025-06-10）：初始发布
---

#### **1. 文档介绍**

**1.1. 文档目的**

本篇文档旨在清晰、详尽地阐述“高考志愿AI决策顾问 (免费体验版)”的产品需求。它将作为产品开发、测试和验收的核心依据，确保远程兼职工程师能够独立、准确地理解并实现所有功能。

**1.2. 项目概述**

本项目旨在开发一款移动端优先的H5单页应用。该应用为面临高考志愿填报最后抉择（此时用户已经通过多方调研形成了最后有限数量的候选志愿学校和专业）、在多个备选方案中纠结的考生及家长，提供一份由AI驱动的、结合了最新招生计划的深度分析报告。其目标是在极短的开发周期内上线，通过提供超预期的免费价值来快速验证产品、积累用户并形成口碑传播（可视情况增加支付功能）。

---

#### **2. 项目背景与战略**

**2.1. 市场问题 (Problem)**

高考志愿填报的窗口期仅有3-4天，是考生和家庭压力最大的时刻。许多用户在做了大量研究后，仍会在2-3个“都很好，但又都有缺陷”的方案中摇摆不定，陷入“决策瘫痪”，害怕因信息差或一时冲动而做出影响未来四年的错误选择。

**2.2. 目标用户 (Target Audience)**

* **核心画像:** "王磊"
* **身份:** 高分段考生或其焦虑的家长。
* **特征:**
    * 已经有明确的2-3个备选方案，对基本规则有所了解。
    * 其纠结点通常是“名校 vs 专业”、“城市 vs 学校”、“风险 vs 收益”等复杂权衡。
    * 具备一定的信息搜集能力，但缺乏将信息结构化并进行深度对比分析的专业能力。

**2.3. 产品目标 (Goals)**

1.  **用户目标:** 帮助用户在10分钟内，获得一份关于其备选方案的、详尽、周到、客观的分析报告，帮助他们理清思路，做出更自信的决策。
2.  **商业目标 (MVP阶段):**
    * **验证核心价值:** 验证“AI+最新数据”的分析报告能否精准解决用户的决策难题。
    * **积累种子用户:** 通过免费模式，在无推广预算的情况下，获取第一批核心用户。
    * **打造口碑效应:** 提供远超预期的免费服务，激励用户自发分享和传播。
    * **控制运营成本:** 通过设置每日服务上限，将API调用成本控制在可接受范围内。

---

#### **3. 用户流程与功能详述**

**3.1. 整体用户流程图**

`用户进入H5页面` -> `提交志愿方案信息` -> `系统显示等待状态` -> `[分支]`
* `分支A (成功):` -> `系统展示AI分析报告`
* `分支B (当日名额已满):` -> `系统显示“名额已满”提示`
* `分支C (输入错误):` -> `系统显示“无法识别”提示`

**3.2. 页面与功能规格 (单页应用内的不同视图)**

#### **视图一：信息提交页 (默认首页)**

* **页面目标:** 引导用户以最便捷的方式，提交他正在纠结的志愿方案信息。
* **页面元素与交互详述:**
    1.  **大标题 (H1):** `临门一脚还在纠结？`
    2.  **副标题 (P):** `免费获取您的专属AI志愿分析报告`
    3.  **信息提交模块:**
        * **元素:** 一个灵活的信息输入区，包含三种用户可选的提交方式（建议用页签Tab切换）。
        * **选项1 (默认): 【直接粘贴笔记】**
            * **元素:** 一个大的文本输入框 (`<textarea>`)。
            * **提示文案 (Placeholder):** `“请将您纠结的几个方案、您的分数位次、以及您的困惑，全部粘贴在这里。格式不限，越详细越好。”`
        * **选项2: 【上传文档】**
            * **元素:** 一个文件上传按钮 (`<input type="file">`)。
            * **提示文案:** `“支持上传您已整理好的文档(Word, Excel, TXT)或截图(JPG, PNG)。”`
            * **交互:** 用户选择文件后，显示文件名。
        * **选项3: 【快速填写】** (作为备用，给没有文档的用户)
            * **元素:** 几个结构化的输入框，包括“分数/位次”、“方案A”、“方案B”、“我的困惑”等。
    4.  **操作按钮 (Button):**
        * **文案:** `立即生成我的分析报告`
        * **交互:** 点击后，按钮变为不可用状态，并触发“视图二：等待页”的显示。前端将收集到的所有信息，打包发送给后端云函数。

#### **视图二：等待页**

* **页面目标:** 在AI分析期间，安抚用户情绪，提供明确的等待预期。
* **页面元素与交互详述:**
    1.  **视觉元素:** 一个动态的、令人愉悦的加载动画（例如雷达扫描、大脑思考等）。
    2.  **提示文案:** `“我们已收到您的信息，强大的AI决策顾问正在为您进行多维度分析，并结合2025年最新招生数据进行演算。预计需要30-60秒，请您耐心等待...”`

#### **视图三：AI分析报告展示页**

* **页面目标:** 清晰、详尽、有条理地展示AI生成的完整报告。
* **页面元素与交互详述:**
    1.  **报告标题:** `您的专属AI决策顾问分析报告`
    2.  **报告内容区:**
        * **交互:** 后端返回的是Markdown格式的文本，前端需将其解析并渲染成带格式的HTML。
        * **内容结构:** 必须包含但不限于：
            * 对用户方案的概述。
            * **“方案PK记分卡”**（必须用表格 `<table>` 清晰呈现）。
            * 对记分卡中每一项的**详细文字解读**。
            * 针对用户个人价值观和困扰的**“对话式”分析与建议**。
            * 最终的**结论总结**。
    3.  **分享按钮:**
        * **文案:** `分享给朋友` 或 `复制报告链接`
        * **交互:** 点击后，可以方便用户分享当前页面的链接。

#### **视图四：异常与限制状态页**

* **页面目标:** 友好地处理异常情况。
* **页面元素与交互详述:**
    1.  **“名额已满”状态:**
        * **触发条件:** 后端返回“今日名额已满”的错误码。
        * **显示文案:** `“非常抱歉，今日的免费体验名额已被抢完！AI顾问正在全力服务中。请您明日再来，或添加我们的官方微信 [微信号]，进入用户群获取最新消息。”`
    2.  **“无法识别”状态:**
        * **触发条件:** 用户输入的信息经过AI初步解析后，无法识别出有效的志愿方案。
        * **显示文案:** `“抱歉，我们暂时无法从您提交的信息中识别出有效的志愿方案。建议您检查后，尝试提供更详细的学校和专业名称，然后重试。”`

---

#### **4. 后端逻辑与数据需求**

* **4.1. AI分析报告生成逻辑:**
    * **输入:**
        1.  用户提交的原始信息（文本或文档内容）。
        2.  一个预置在后台的 `enrollment_data_2025.json` 文件，包含各校专业在各省的最新招生计划变化（+5人, -3人, 0人等）。
    * **处理:**
        1.  AI首先对用户原始信息进行解析，提取出关键字段（位次、方案A/B等）。
        2.  AI结合提取出的信息和`enrollment_data_2025.json`中的数据，生成一份结构化的、包含前文所述“专业版记分卡”和“周到版分析”的Markdown文本。
    * **输出:** 一份完整的Markdown格式的分析报告。

* **4.2. 成本控制逻辑:**
    * 需要一个云端键值数据库（如Vercel KV, Redis, Upstash等），只存储一个键：`daily_requests_count`。
    * 每次成功调用AI生成报告后，该值+1。
    * 每次有新请求时，先读取该值。如果超过设定的阈值（例如1000），则拒绝服务，并返回“名额已满”的状态。
    * 需要一个定时任务，在每日零点自动将该值重置为0。

---



#### **5. MVP范围外 (Out of Scope)**

* 用户登录与注册系统。
* 历史报告的保存与查询功能。
* 任何形式的在线支付功能。
* 除核心报告生成外的其他任何功能。

## V1.1 新增功能与变更详情

### 1. 极简用户认证与速率限制

- **认证方式：**
    - 仅邀请码/密码校验，适合小范围内测，密码在后端文件中配置。
- **速率限制参数**可在配置文件中灵活调整。

### 2. 多轮上下文追问

- 支持用户在首轮报告基础上连续追问，AI自动带入最近N轮上下文（默认3轮）。
- 对话历史在后端以sessionId为单位存储，前端无需处理历史。

### 3. 背景数据极简导入

- 后端/data/scorelines/目录直接存放分数线/一分一段线JSON文件。
- 数据结构示例见技术开发文档（TD），包括省份、年份、分数线、累计等字段。
- 后端自动按省份/年份/科类检索和加载数据，无需数据库。

### 4. 配置项集中管理

- 新增config.json用于统一管理下列参数：
    - 认证方式
    - 速率限制
    - 多轮上下文历史长度

---

## 兼容与迁移说明

- 以上功能均为向下兼容增强，原有1.0功能不变。
- 推荐数据准备人员按照新JSON结构整理数据，直接上传至指定目录即可。

---
